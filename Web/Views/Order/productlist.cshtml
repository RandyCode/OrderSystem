@{
    Layout = "~/Views/Template/dialog.cshtml";
}


@section title {
    <h4 style="font-weight:bold"><label>物料列表</label></h4>
}

@section Message{

    <div class="box-body" >
    <div class="dataTables_wrapper form-inline dt-bootstrap">
        <div class="row">
            <div class="col-sm-6"></div><div class="col-sm-6"></div>
        </div>
        <div class="row">
            <div class="col-sm-12">
                <table class="table table-bordered table-hover dataTable" role="grid" id="productlist_table">
                    <thead>
                        <tr role="row">
                            <th tabindex="0">物料编号</th>
                            <th tabindex="0">物料名称</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model)
                        {
                            <tr role="row">
                                <td>@item.ItemCode</td>
                                <td>@item.ItemName</td>
                            </tr>
                        }
                    </tbody>

                </table>

            </div>
        </div>

        <div class="row">
            <div class="col-sm-5"><div class="dataTables_info">当前第 @(ViewBag.PageIndex + 1) 页（共 @ViewBag.TotalPages 页）</div></div>
            @if (ViewBag.TotalPages != null && ViewBag.TotalPages > 1)
            {
                <div class="col-sm-7">
                    <div class="dataTables_paginate" id="paginate">
                        <ul class="pagination">

                            @{
                var currentPage = (int)ViewBag.PageIndex + 1;
                var beginIndex = 1;
                if (currentPage < 4)
                { beginIndex = 1; }
                else if (currentPage >= (ViewBag.TotalPages - 4))
                { beginIndex = (int)ViewBag.TotalPages - 4; }
                else
                { beginIndex = currentPage - 2; }
                var count = ViewBag.TotalPages < (beginIndex + 4) ? ViewBag.TotalPages : (beginIndex + 4);
                            }

                            <li class="paginate_button  @(ViewBag.PageIndex==0?"disabled":"") ">
                                <a href="@(ViewBag.PageIndex == 0 ? "#" : Url.Content("~/order/index?key=" + ViewBag.Key + "&&pageIndex=" + (currentPage - 2)))">上一页</a>
                            </li>

                            @for (int i = beginIndex; i <= count; i++)
                            {
                                <li class="paginate_button @(i == currentPage ? "active" : "") ">
                                    <a href="@Url.Content("~/order/index?key=" + ViewBag.Key + "&&pageIndex=" + (i - 1))">@i</a>
                                </li>
                            }

                            <li class="paginate_button @(ViewBag.TotalPages == (ViewBag.PageIndex+1) ? "disabled" : "") ">
                                <a href="@(ViewBag.TotalPages == (ViewBag.PageIndex + 1) ? "#" : Url.Content("~/order/index?key=" + ViewBag.Key + "&&pageIndex=" + currentPage))">下一页</a>
                            </li>
                        </ul>
                    </div>
                </div>
            }
        </div>

    </div>
</div>





}

@section buttons{
    <button type="button" class="btn btn-primary" data-dismiss="modal" id="comfirm_code">确定</button>
    <button type="button" class="btn btn-default" data-dismiss="modal" id="cancel_code">取消</button>
    <script>
        $(function () {
            //tr click
            $("#productlist_table tr").each(function () {
                var itemcode;
                var itemname;
                $(this).click(function () {
            
                    if (itemcode == $(this).children('td').html()) {
                        $(this).css("background", "");
                    }
                    itemcode = $(this).children('td').first().html();
                    itemname = $(this).children('td').last().html();
                    console.log(itemcode+","+itemname);
                    $(this).css("background", "#f4f4f4");
                    $(this).siblings("tr").css("background", "");
                    $("#itemcode").val(itemcode);
                    $("#itemname").val(itemname);

                }).dblclick(function () {
                    usercode = $(this).children('td').html();
                    $("#itemcode").val(itemcode);
                    $("#itemname").val(itemname);
                    $("#comfirm_code").click();
                });
            });
            //取消
            $("#cancel_code").click(function () { $("#itemcode").val(''); $("#itemname").val(''); });




    })

   </script>
}

